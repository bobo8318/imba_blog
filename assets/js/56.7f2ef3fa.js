(window.webpackJsonp=window.webpackJsonp||[]).push([[56],{402:function(s,a,t){"use strict";t.r(a);var e=t(43),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker"}},[s._v("#")]),s._v(" Docker")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#docker-composeyml%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"}},[s._v("docker-compose.yml基本介绍")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#ports"}},[s._v("ports")])])])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%8D%B8%E8%BD%BD%E6%97%A7%E7%89%88%E6%9C%AC"}},[s._v("卸载旧版本")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%BC%80%E5%A7%8B%E5%AE%89%E8%A3%85docker"}},[s._v("开始安装docker")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#%E8%AE%BE%E7%BD%AE%E7%A8%B3%E5%AE%9A%E7%9A%84%E5%AD%98%E5%82%A8%E5%BA%93"}},[s._v("设置稳定的存储库。")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E7%A6%81%E7%94%A8%E6%B5%8B%E8%AF%95%E5%BA%93"}},[s._v("禁用测试库")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%AE%89%E8%A3%85%E6%9C%80%E6%96%B0%E7%89%88%E6%9C%AC%E7%9A%84docker-ce"}},[s._v("安装最新版本的Docker CE")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%88%97%E5%87%BA%E5%8F%AF%E7%94%A8%E7%89%88%E6%9C%AC%E4%BB%8E%E6%9C%80%E9%AB%98%E5%88%B0%E6%9C%80%E4%BD%8E%E6%8E%92%E5%BA%8F"}},[s._v("列出可用版本,从最高到最低排序")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%AE%89%E8%A3%85%E4%B8%80%E4%B8%AA%E5%BA%93"}},[s._v("安装一个库")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%90%AF%E5%8A%A8docker"}},[s._v("启动Docker")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E6%9F%A5%E7%9C%8B%E6%9C%AC%E5%9C%B0%E9%95%9C%E5%83%8F"}},[s._v("查看本地镜像")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E6%90%9C%E7%B4%A2%E9%95%9C%E5%83%8F"}},[s._v("搜索镜像")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E4%B8%8B%E8%BD%BD%E9%95%9C%E5%83%8F"}},[s._v("下载镜像")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E9%AA%8C%E8%AF%81%E5%AE%89%E8%A3%85"}},[s._v("验证安装")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%90%AF%E5%8A%A8"}},[s._v("启动")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%85%B6%E4%BB%96docker%E5%91%BD%E4%BB%A4"}},[s._v("其他docker命令")])])])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E6%9E%84%E5%BB%BA%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6"}},[s._v("构建镜像文件")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"#%E5%87%86%E5%A4%87centos%E5%9F%BA%E7%A1%80%E9%95%9C%E5%83%8F"}},[s._v("准备CentOS基础镜像")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E4%B8%8B%E8%BD%BD"}},[s._v("下载")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%88%9B%E5%BB%BA%E7%9B%AE%E5%BD%95"}},[s._v("创建目录")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E8%A7%A3%E5%8E%8B"}},[s._v("解压")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%88%A0%E9%99%A4%E5%A4%9A%E4%BD%99%E6%96%87%E4%BB%B6"}},[s._v("删除多余文件")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%88%9B%E5%BB%BAdockerfile"}},[s._v("创建Dockerfile")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E6%8F%92%E5%85%A5%E4%BB%A5%E4%B8%8B%E5%86%85%E5%AE%B9"}},[s._v("插入以下内容")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%BC%80%E5%A7%8B%E6%9E%84%E5%BB%BAdocker%E9%95%9C%E5%83%8F%E6%96%87%E4%BB%B6"}},[s._v("开始构建docker镜像文件")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E6%9F%A5%E7%9C%8B%E9%95%9C%E5%83%8F%E6%98%AF%E5%90%A6%E5%88%9B%E5%BB%BA%E6%88%90%E5%8A%9F"}},[s._v("查看镜像是否创建成功")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%90%AF%E5%8A%A8%E5%AE%B9%E5%99%A8"}},[s._v("启动容器")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%BC%80%E6%94%BE%E7%AB%AF%E5%8F%A3"}},[s._v("开放端口")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E6%9F%A5%E7%9C%8Bdocker%E8%BF%90%E8%A1%8C%E7%8A%B6%E6%80%81"}},[s._v("查看docker运行状态")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E8%BF%90%E8%A1%8Ctomcat"}},[s._v("运行Tomcat")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%81%9C%E6%AD%A2tomcat"}},[s._v("停止Tomcat")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%BC%BA%E5%88%B6%E5%88%A0%E9%99%A4%E4%B8%80%E4%B8%AA%E8%BF%90%E8%A1%8C%E4%B8%AD%E7%9A%84%E5%AE%B9%E5%99%A8"}},[s._v("强制删除一个运行中的容器")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%81%9C%E6%AD%A2container"}},[s._v("停止container")])]),s._v(" "),t("li",[t("a",{attrs:{href:"#%E5%88%A0%E9%99%A4images"}},[s._v("删除images")])])])])]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.docker.com/install/linux/docker-ce/centos/",target:"_blank",rel:"noopener noreferrer"}},[s._v("docker官网centos7安装"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"docker-compose-yml基本介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-compose-yml基本介绍"}},[s._v("#")]),s._v(" docker-compose.yml基本介绍")]),s._v(" "),t("p",[t("a",{attrs:{href:"http://ju.outofmemory.cn/entry/287017",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://ju.outofmemory.cn/entry/287017"),t("OutboundLink")],1)]),s._v(" "),t("blockquote",[t("p",[s._v("Compose 文件是一个 YAML , 主要定义了 services , networks 和 volumes ， 其默认路径是 ./docker-compose.yml 。")])]),s._v(" "),t("blockquote",[t("p",[s._v("service 定义包含了应用与每个容器的配置，很像给 docker run 传参，同样，\nnetwork 和 volume 对于 docker network create 和 docker volume create 也类似。")])]),s._v(" "),t("blockquote",[t("p",[s._v("像在 Dockerfile (eg: CMD , EXPOSE , VOLUME , ENV )可以使用的选项也可以在 "),t("code",[s._v("docker run")]),s._v("参数中使用，\n这样在 docker-compose.yml 里就不需要再次指定了。")])]),s._v(" "),t("blockquote",[t("p",[s._v("docker-compose.yml 里可以使用环境变量，类似 Bash 格式 ${VARIABLE}")])]),s._v(" "),t("blockquote",[t("p",[s._v("composer 文件格式有两种版本：")])]),s._v(" "),t("blockquote",[t("blockquote",[t("p",[s._v("version 1: 已经废弃， 不支持volumes 和 networks，默认 version key 是省略的。")])])]),s._v(" "),t("blockquote",[t("blockquote",[t("p",[s._v("version 2: 推荐的格式，目前是最新的，需要通过 version '2' 指定。")])])]),s._v(" "),t("h3",{attrs:{id:"ports"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#ports"}},[s._v("#")]),s._v(" ports")]),s._v(" "),t("blockquote",[t("p",[s._v("暴露端口。既可以是 HOST:CONTAINER ，也可以只用容器端口(host端口会随机选取)。\n当以 HOST:CONTAINER 的形式映射端口的时候，当容器的端口低于60的时候可能会遇到错误，\n因为YAML会解析 xx:yy 数字为60。 基于这个原因，我们推荐明确指定端口映射用字符串的形式。")])]),s._v(" "),t("blockquote",[t("p",[s._v("volumes")]),s._v(" "),t("blockquote",[t("p",[s._v("挂载指定的路径或者named volumes, 可以在主机上指定一个路径 HOST:CONTAINER ,\n或者一个可访问的 HOST:CONTAINER:ro 。")])])]),s._v(" "),t("h2",{attrs:{id:"卸载旧版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#卸载旧版本"}},[s._v("#")]),s._v(" 卸载旧版本")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum remove docker "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker-client "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker-client-latest "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker-common "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker-latest "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker-latest-logrotate "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker-logrotate "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker-selinux "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker-engine-selinux "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndocker-engine\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("h2",{attrs:{id:"开始安装docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开始安装docker"}},[s._v("#")]),s._v(" 开始安装docker")]),s._v(" "),t("blockquote",[t("p",[s._v("安装所需的包。yum-utils提供了yum-config-manager效用，\n并device-mapper-persistent-data和lvm2由需要devicemapper存储驱动程序。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y yum-utils "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\ndevice-mapper-persistent-data "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\nlvm2\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"设置稳定的存储库。"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#设置稳定的存储库。"}},[s._v("#")]),s._v(" 设置稳定的存储库。")]),s._v(" "),t("blockquote",[t("p",[s._v("即使您想从边缘或测试存储库安装构建，也总是需要稳定的存储库。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum-config-manager --enable docker-ce-edge\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"禁用测试库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#禁用测试库"}},[s._v("#")]),s._v(" 禁用测试库")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum-config-manager --disable docker-ce-edge\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"安装最新版本的docker-ce"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装最新版本的docker-ce"}},[s._v("#")]),s._v(" 安装最新版本的Docker CE")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"列出可用版本-从最高到最低排序"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#列出可用版本-从最高到最低排序"}},[s._v("#")]),s._v(" 列出可用版本,从最高到最低排序")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v(" yum list docker-ce --showduplicates "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sort")]),s._v(" -r\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"安装一个库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装一个库"}},[s._v("#")]),s._v(" 安装一个库")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("VERSION STRING"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#例如")]),s._v("\nyum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce-18.03.1.ce\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"启动docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动docker"}},[s._v("#")]),s._v(" 启动Docker")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("systemctl start docker\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"查看本地镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看本地镜像"}},[s._v("#")]),s._v(" 查看本地镜像")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker images\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"搜索镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#搜索镜像"}},[s._v("#")]),s._v(" 搜索镜像")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 搜索centos有关的镜像")]),s._v("\ndocker search centos\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"下载镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载镜像"}},[s._v("#")]),s._v(" 下载镜像")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# centos镜像")]),s._v("\ndocker pull centos\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"验证安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#验证安装"}},[s._v("#")]),s._v(" 验证安装")]),s._v(" "),t("blockquote",[t("p",[s._v("通过运行"),t("code",[s._v("hello-world")]),s._v("映像验证安装是否正确。")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker run hello-world\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[s._v("#")]),s._v(" 启动")]),s._v(" "),t("blockquote",[t("p",[s._v("启动一个基于"),t("code",[s._v("docker.io/centos")]),s._v("的容器")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker run -it --name"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("test-centos docker.io/centos:latest /bin/bash\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[t("code",[s._v("-it")]),s._v(" 表示交互模式, 启动成功后进入命令行")]),s._v(" "),t("p",[t("code",[s._v("-d")]),s._v(" 表示守护模式, 容器在后台运行")]),s._v(" "),t("p",[t("code",[s._v("--name")]),s._v(" 为容器命名")]),s._v(" "),t("p",[t("code",[s._v("docker.io/centos:latest")]),s._v(" 格式为镜像名:版本")]),s._v(" "),t("p",[t("code",[s._v("/bin/bash")]),s._v(" 进入bash命令行")])]),s._v(" "),t("h3",{attrs:{id:"其他docker命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其他docker命令"}},[s._v("#")]),s._v(" 其他docker命令")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 退出docker容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果容器内部没有任何程序运行, 一旦执行exit, 退出容器时, 容器将结束运行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看运行中的容器")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看全部的容器, 包括运行中和已停止运行的容器")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过容器名称删除已经停止运行的容器(test-centos为docker run命令中给容器的命名)")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" test-centos\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过容器ID删除已经停止运行的容器,与上面的命令效果一样, 060e是containerID的前4位")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" 060e\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制删除状态为Up, 正在运行中的容器")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f test-centos\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h2",{attrs:{id:"构建镜像文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#构建镜像文件"}},[s._v("#")]),s._v(" 构建镜像文件")]),s._v(" "),t("h3",{attrs:{id:"准备centos基础镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#准备centos基础镜像"}},[s._v("#")]),s._v(" 准备CentOS基础镜像")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker pull centos\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"下载"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载"}},[s._v("#")]),s._v(" 下载")]),s._v(" "),t("p",[t("a",{attrs:{href:"http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("JDK7下载地址"),t("OutboundLink")],1)]),s._v(" "),t("p",[t("a",{attrs:{href:"https://tomcat.apache.org/download-80.cgi",target:"_blank",rel:"noopener noreferrer"}},[s._v("tomcat8.5下载地址"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"创建目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建目录"}},[s._v("#")]),s._v(" 创建目录")]),s._v(" "),t("blockquote",[t("p",[s._v("在home文件夹下创建docker目录")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /home/docker\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"解压"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#解压"}},[s._v("#")]),s._v(" 解压")]),s._v(" "),t("blockquote",[t("p",[s._v("把JDK和Tomcat都解压到/home/docker文件夹下，建议重命名为最简单的名称")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf jdk-7u80-linux-i586.tar.gz -C /home/docker\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf apache-tomcat-8.5.32.tar.gz -C /home/docker\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重命名")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" /home/docker/apache-tomcat-8.5.32.tar.gz /home/docker/tomcat-8080\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("h3",{attrs:{id:"删除多余文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除多余文件"}},[s._v("#")]),s._v(" 删除多余文件")]),s._v(" "),t("blockquote",[t("p",[s._v("删掉jdk文件夹下多余文件, 降低build的镜像大小")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /data/docker/jdk1.7.0_80/*src.zip "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/lib/missioncontrol "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/lib/visualvm "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/lib/*javafx* "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/plugin.jar "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/ext/jfxrt.jar "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/bin/javaws "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/javaws.jar "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/desktop "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/plugin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/deploy* "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/*javafx* "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/*jfx* "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/amd64/libdecora_sse.so "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/amd64/libprism_*.so "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/amd64/libfxplugins.so "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/amd64/libglass.so "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/amd64/libgstreamer-lite.so "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/amd64/libjavafx*.so "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/data/docker/jdk1.7.0_80/jre/lib/amd64/libjfx*.so\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br")])]),t("h3",{attrs:{id:"创建dockerfile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建dockerfile"}},[s._v("#")]),s._v(" 创建Dockerfile")]),s._v(" "),t("blockquote",[t("p",[s._v("进入"),t("code",[s._v("/home/docker")]),s._v("文件夹并创建"),t("code",[s._v("Dockerfile")]),s._v("文件")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home/docker "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vi")]),s._v(" Dockerfile\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"插入以下内容"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#插入以下内容"}},[s._v("#")]),s._v(" 插入以下内容")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用的基础镜像")]),s._v("\nFROM centos\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 作者信息")]),s._v("\nMAINTAINER bajins "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"claer@bajins.com"')]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建目录")]),s._v("\nRUN "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /data/java/jdk1.7.0_80\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把当前目录下的jdk文件夹添加到镜像")]),s._v("\nADD jdk1.7.0_80 /data/java/jdk1.7.0_80\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建tomcat目录")]),s._v("\nRUN "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" -p /data/java/tomcat-8080\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把当前目录下的tomcat文件夹添加到镜像")]),s._v("\nADD tomcat-8080 /data/java/tomcat-8080\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加环境变量")]),s._v("\nENV JAVA_HOME /data/java/jdk1.7.0_80\nENV CATALINA_HOME /data/java/tomcat-8080\nENV "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin:"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$CATALINA_HOME")]),s._v("/bin\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暴露端口")]),s._v("\nEXPOSE "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v("\nEXPOSE "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8090")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动时运行tomcat")]),s._v("\nCMD "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/data/java/tomcat-8080/bin/catalina.sh"')]),s._v(","),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"run"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br")])]),t("h3",{attrs:{id:"开始构建docker镜像文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开始构建docker镜像文件"}},[s._v("#")]),s._v(" 开始构建docker镜像文件")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker build -t repos_local/centos-jdk7-tomcat85:0.0.1 "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[t("code",[s._v("-t")]),s._v(" 设置tag名称, 命名规则registry/image:tag")]),s._v(" "),t("p",[t("code",[s._v(".")]),s._v(" 表示使用当前目录下的Dockerfile文件")])]),s._v(" "),t("h3",{attrs:{id:"查看镜像是否创建成功"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看镜像是否创建成功"}},[s._v("#")]),s._v(" 查看镜像是否创建成功")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker images\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"启动容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动容器"}},[s._v("#")]),s._v(" 启动容器")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker run -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v(":8080 --name tomcat-8080 repos_local/centos-jdk7-tomcat85:0.0.1\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("blockquote",[t("p",[t("code",[s._v("-d")]),s._v(" 后台运行")]),s._v(" "),t("p",[t("code",[s._v("-p")]),s._v(" 宿主机port:容器port 端口映射,外部访问的是宿主机端口")]),s._v(" "),t("p",[t("code",[s._v("--name")]),s._v(" 容器名称, 可以通过容器名称对容器操作")])]),s._v(" "),t("h3",{attrs:{id:"开放端口"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#开放端口"}},[s._v("#")]),s._v(" 开放端口")]),s._v(" "),t("blockquote",[t("p",[s._v("CentOS7下可以直接使用firewall-cmd来开放端口")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开放8081端口  permanent为永久开放")]),s._v("\nfirewall-cmd --zone"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("public --add-port"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8081")]),s._v("/tcp --permanent\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重新读取配置")]),s._v("\nfirewall-cmd --reload\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看全部开放端口")]),s._v("\nfirewall-cmd --list-all\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果提示FirewallD is not running执行systemctl start firewalld.service, 启动firewalld服务")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("h3",{attrs:{id:"查看docker运行状态"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看docker运行状态"}},[s._v("#")]),s._v(" 查看docker运行状态")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"运行tomcat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行tomcat"}},[s._v("#")]),s._v(" 运行Tomcat")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker start tomcat-8080\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"停止tomcat"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#停止tomcat"}},[s._v("#")]),s._v(" 停止Tomcat")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker stop tomcat-8080\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("h3",{attrs:{id:"强制删除一个运行中的容器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#强制删除一个运行中的容器"}},[s._v("#")]),s._v(" 强制删除一个运行中的容器")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -f tomcat-8080\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#docker rm 命令删除一个Exited状态的容器, docker rm -f 强制删除一个运行中的容器")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("h3",{attrs:{id:"停止container"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#停止container"}},[s._v("#")]),s._v(" 停止container")]),s._v(" "),t("blockquote",[t("p",[s._v("停止所有的"),t("code",[s._v("container")]),s._v("，这样才能够删除其中的"),t("code",[s._v("images")])])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker stop "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a -q"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果想要删除所有container的话再加一个指令：")]),s._v("\ndocker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("docker "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" -a -q"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br")])]),t("h3",{attrs:{id:"删除images"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#删除images"}},[s._v("#")]),s._v(" 删除images")]),s._v(" "),t("blockquote",[t("p",[s._v("通过image的id来指定删除谁")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker rmi "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("image id"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#想要删除untagged images，也就是那些id为<None>的image的话可以用")]),s._v("\ndocker rmi "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("docker images "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"^<none>"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("awk")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"{print '),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$3")]),s._v('}"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#要删除全部image的话")]),s._v("\ndocker rmi "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),s._v("docker images -q"),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("docker run -it \n\ndocker run -i -t -v /home:/home/docker 89796a /bin/bash\n\ndocker run -d -p "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":8080 "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n-v /home/tomcat/webapps/:/home/tomcat-8080/webapps/ "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n--name bajins bajins/centos-jt:1.0 /home/run.sh\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("blockquote",[t("p",[t("code",[s._v("-v")]),s._v(" 略，如前所述说")]),s._v(" "),t("p",[t("code",[s._v("-d")]),s._v(' 表示以"守护模式"执行/root/run.sh脚本，此时 Tomcat 控制台不会出现在输出终端上')]),s._v(" "),t("p",[t("code",[s._v("-p")]),s._v(" 表示宿主机与容器的端口映射，此时将容器内部的8080端口映射为宿主机的58080端口，\n这样就向外界暴露了58080端口，可通过Docker网桥来访问容器内部的8080端口了")]),s._v(" "),t("p",[t("code",[s._v("--name")]),s._v(" 表示容器名称，用一个你觉得有意义的名称命名即可")]),s._v(" "),t("p",[t("code",[s._v("test_tomcat:1.0")]),s._v(" 即新容器名:TAG")]),s._v(" "),t("p",[t("code",[s._v("/root/run.sh")]),s._v(" 即需要执行的脚本")])]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token shebang important"}},[s._v("#!/bin/bash")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("JAVA_HOME")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/home/java/jdk1.7.0_80\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PATH")])]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$JAVA_HOME")]),s._v("/bin:"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("$PATH")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sh")]),s._v(" /home/tomcat-8080/bin/catalina.sh run\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" a+x run.sh\n\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" -rf /home/jdk1.7.0_80/*src.zip "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/lib/missioncontrol "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/lib/visualvm "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/lib/*javafx* "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/plugin.jar "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/ext/jfxrt.jar "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/bin/javaws "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/javaws.jar "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/desktop "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/plugin "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/deploy* "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/*javafx* "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/*jfx* "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/amd64/libdecora_sse.so "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/amd64/libprism_*.so "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/amd64/libfxplugins.so "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/amd64/libglass.so "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/amd64/libgstreamer-lite.so "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/amd64/libjavafx*.so "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n/home/jdk1.7.0_80/jre/lib/amd64/libjfx*.so\n\t\n\t\n\ndocker commit -m"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Added jdk_tomcat"')]),s._v(" -a"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bajins"')]),s._v(" 44652ba46352 bajins/centos-jt:1.0\n-m:提交的描述信息\n\n-a:指定镜像作者\n\n44652ba46352：容器ID\n\nbajins/centos-jt:1.0:指定要创建的目标镜像名,1.0版本\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);