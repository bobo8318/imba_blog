(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{445:function(s,n,e){"use strict";e.r(n);var a=e(43),t=Object(a.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h1",{attrs:{id:"springboot-知识汇总"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#springboot-知识汇总"}},[s._v("#")]),s._v(" springboot 知识汇总")]),s._v(" "),e("h3",{attrs:{id:"springboot"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#springboot"}},[s._v("#")]),s._v(" springboot")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("mybatis")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("mybatis plus mybatis增强工具")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('// 实体类\n@Data\n@TableName(value = "user")\npublic class User{\n\t@TableField(value = "age")\n\tprivate Integer userAge;\n}\n\n// mapper\n@mapper\npublic interface Usermapper extends BaseMapper<User>{\n\t\n}\n\n// 分页\n@Bean\npublic PaginationInterceptor paginationInterceptor(){\n\treturn new PaginationInterceptor();\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("注解方式获得自增id")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('@Insert("insert into tbl_user (name, age) values (#{name}, #{age})")\n@Options(useGeneratedKeys=true, keyProperty="userId", keyColumn="id")\nvoid insertUser(User user);\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("pagehelper :分页工具")]),s._v(" "),e("blockquote",[e("p",[s._v("compile('com.github.pagehelper:pagehelper-spring-boot-starter:1.2.3')")])]),s._v(" "),e("ul",[e("li",[e("p",[s._v("properties")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("pagehelper.helperDialect=mysql\npagehelper.reasonable=true\npagehelper.supportMethodsArguments=true\npagehelper.params=count=countSql\npagehelper.page-size-zero=true\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("参数说明")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("//当前页\nprivate int pageNum;\n//每页的数量\nprivate int pageSize;\n//当前页的数量\nprivate int size;\n//当前页面第一个元素在数据库中的行号\nprivate int startRow;\n//当前页面最后一个元素在数据库中的行号\nprivate int endRow;\n//总记录数\nprivate long total;\n//总页数\nprivate int pages;\n//结果集\nprivate List<T> list;\n//第一页\nprivate int firstPage;\n//前一页\nprivate int prePage;\n//是否为第一页\nprivate boolean isFirstPage;\n//是否为最后一页\nprivate boolean isLastPage;\n//是否有前一页\nprivate boolean hasPreviousPage;\n//是否有下一页\nprivate boolean hasNextPage;\n//导航页码数\nprivate int navigatePages;\n//所有导航页号\nprivate int[] navigatepageNums;\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("使用")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("PageHelper.startPage(page, size);\nList<UserInfo> userInfoList = userInfoMapper.selectAll();\nPageInfo<UserInfo> pageInfo = new PageInfo<>(userInfoList);\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])])])])])])])])]),s._v(" "),e("p",[s._v("​")]),s._v(" "),e("ul",[e("li",[e("p",[s._v("test:spring-boot-starter-test")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("@RunWith(SpringRunner.class)\n@SpringBootTest\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("ul",[e("li",[e("p",[s._v("mockmvc")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v(' @AutoConfigureMockMvc\n \n @MockBean //  @MockBean 会将mock的bean替换掉 SpringBoot 管理的原生bean，从而达到mock的效果。\n  private XXXDao xxxtDao;\n  \n  \n  Mockito.when(\n        xxxDao.findMapBySql(\n                Mockito.anyString(),Mockito.anyList()\n        )\n ).thenReturn(dataList);\n \n \n // http请求\n \n//配置MockMvc\n@Autowired\nprotected MockMvc mockMvc;\n@Test\npublic void TestXXX() throws Exception {\n       MvcResult result = mockMvc.perform(\n                MockMvcRequestBuilders.get("/xxxController/xxx_query")\n                        .contentType(MediaType.APPLICATION_JSON_UTF8)      \n                        .param("xxx","xxx")\n                    \n\n        \t\t)\n                .andExpect(MockMvcResultMatchers.status().isOk())\n                .andDo(MockMvcResultHandlers.print())\n                .andReturn();\n       \n    }\n｝\n//静态导入 简化\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br")])])])])])]),s._v(" "),e("p",[s._v("import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders."),e("em",[s._v(";\nimport static org.springframework.test.web.servlet.result.MockMvcResultMatchers.")]),s._v(";")]),s._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",[e("code",[s._v('String content = "{\\"username\\":\\"pj_mike\\",\\"password\\":\\"123456\\"}";\nmockMvc.perform(request(HttpMethod.POST, "/user")\n        .contentType("application/json").content(content))\n        .andExpect(status().isOk())\n        .andExpect(content().string("ok"));\n\n\n```\n\n\n\n| .perform()   | 执行一个MockMvcRequestBuilders请求。其中`.get()`表示发送get请求（可以使用get、post、put、delete等）；`.contentType()`设置编码格式；`.param()`请求参数,可以带多个。 |\n| ------------ | ------------------------------------------------------------ |\n| andExpect()  | 加 MockMvcResultMatchers验证规则，验证执行结果是否正确       |\n| .andDo()     | 添加 MockMvcResultHandlers结果处理器,这是可以用于打印结果输出。 |\n| .andReturn() | 结果还回，然后可以进行下一步的处理。                         |\n')])])]),e("ul",[e("li",[e("p",[s._v("单元测试的时候，如果不想造成垃圾数据，可以开启事务功能，在方法或类头部添加 @Transactional 注解即可")])]),s._v(" "),e("li",[e("p",[s._v("真实Web环境进行测试")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('@RunWith(SpringRunner.class)\n@SpringBootTest(webEnvironment = SpringBootTest.WebEnvironment.RANDOM_PORT)\npublic class UserControllerTest3 {\n  @Autowired\n  private TestRestTemplate testRestTemplate;//RestTemplate的一种替代品\n  @Test\n  public void userMapping() throws Exception {\n    User user = new User();\n    user.setUsername("pj_pj");\n    user.setPassword("123456");\n    ResponseEntity<String> responseEntity = testRestTemplate.postForEntity("/user", user, String.class);\n    System.out.println("Result: "+responseEntity.getBody());\n    System.out.println("状态码: "+responseEntity.getStatusCodeValue());\n  }\n}\n \n \n MultiValueMap,StringUtils,HttpEntity,ResponseEntity\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("configuration")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v('\n@Bean("primaryDataSource")\n@Primary\n@ConfigurationProperties("primary.datasource")\npublic DataSource buildPrimaryDataSource() {\n\treturn DataSourceBuilder.create().build();\n\n}\n\n\n@Component\n@ConfigurationProperties("sharding.datasource")\npublic class DataSourceConfig {\n\tprivate String url;\n\t\n\tpublic String getUrl() {\n\t\treturn url;\n\t}\n \n\tpublic void setUrl(String url) {\n\t\tthis.url = url;\n\t}\n\n}\n')])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br")])])]),s._v(" "),e("li",[e("p",[s._v("tomcat容器无法启动")]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("NoSuchMethodError: javax.servlet.ServletContext.getVirtualServerName()Ljava/lang/String;\n\n搞定。我的问题其实不是jar冲突，准备说是ServletContext接口冲突 了。项目依赖了tomcat-embed-core-8.5.31.jar已经有ServletContext了，并且ServletContext接口确确实实定义了getVirtualServerName（）方法，只不过jvm先加载了servelt-api中的ServletContext类，后来在加载tomcat-embed-core-8.5.31中的ServletContext时发现它已经存在就不再加载了。\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br")])])])])])}),[],!1,null,null,null);n.default=t.exports}}]);