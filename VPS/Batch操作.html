<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Batch操作 | IMBAPUB</title>
    <meta name="generator" content="VuePress 1.5.0">
    <link rel="icon" href="/logo.jpg">
    <meta name="description" content="这真的很imba">
    <link rel="preload" href="/assets/css/0.styles.471cf497.css" as="style"><link rel="preload" href="/assets/js/app.c2625d5e.js" as="script"><link rel="preload" href="/assets/js/2.3a46498f.js" as="script"><link rel="preload" href="/assets/js/53.1fb124a5.js" as="script"><link rel="prefetch" href="/assets/js/10.2018e9fd.js"><link rel="prefetch" href="/assets/js/100.2b4f1706.js"><link rel="prefetch" href="/assets/js/101.4e2ee47c.js"><link rel="prefetch" href="/assets/js/102.a30f6619.js"><link rel="prefetch" href="/assets/js/103.009c7e6e.js"><link rel="prefetch" href="/assets/js/104.93b9bc4e.js"><link rel="prefetch" href="/assets/js/105.ce02a061.js"><link rel="prefetch" href="/assets/js/106.829b94f8.js"><link rel="prefetch" href="/assets/js/107.36c4f04c.js"><link rel="prefetch" href="/assets/js/108.36b6dcb7.js"><link rel="prefetch" href="/assets/js/109.037bb113.js"><link rel="prefetch" href="/assets/js/11.823d6f8d.js"><link rel="prefetch" href="/assets/js/110.65e37569.js"><link rel="prefetch" href="/assets/js/111.6f27cd54.js"><link rel="prefetch" href="/assets/js/112.56d99c63.js"><link rel="prefetch" href="/assets/js/113.4d67ef64.js"><link rel="prefetch" href="/assets/js/114.34a6aece.js"><link rel="prefetch" href="/assets/js/115.666c7083.js"><link rel="prefetch" href="/assets/js/116.bc4dcb5a.js"><link rel="prefetch" href="/assets/js/117.4b4c61a2.js"><link rel="prefetch" href="/assets/js/118.39f1a48f.js"><link rel="prefetch" href="/assets/js/119.43afcb26.js"><link rel="prefetch" href="/assets/js/12.ef380254.js"><link rel="prefetch" href="/assets/js/120.e03e4153.js"><link rel="prefetch" href="/assets/js/121.420691b9.js"><link rel="prefetch" href="/assets/js/122.970c8e3c.js"><link rel="prefetch" href="/assets/js/13.697ff2be.js"><link rel="prefetch" href="/assets/js/14.d9443a9c.js"><link rel="prefetch" href="/assets/js/15.ed70dfb0.js"><link rel="prefetch" href="/assets/js/16.77e1e60d.js"><link rel="prefetch" href="/assets/js/17.6eced122.js"><link rel="prefetch" href="/assets/js/18.5af74e2c.js"><link rel="prefetch" href="/assets/js/19.150015fd.js"><link rel="prefetch" href="/assets/js/20.a1dd4619.js"><link rel="prefetch" href="/assets/js/21.d67b98a9.js"><link rel="prefetch" href="/assets/js/22.c9d1bbd2.js"><link rel="prefetch" href="/assets/js/23.4176bb24.js"><link rel="prefetch" href="/assets/js/24.b7f8575c.js"><link rel="prefetch" href="/assets/js/25.d78b5608.js"><link rel="prefetch" href="/assets/js/26.309cbfe1.js"><link rel="prefetch" href="/assets/js/27.9489af17.js"><link rel="prefetch" href="/assets/js/28.9cca7ff8.js"><link rel="prefetch" href="/assets/js/29.c6f85384.js"><link rel="prefetch" href="/assets/js/3.49eb4b3d.js"><link rel="prefetch" href="/assets/js/30.19535190.js"><link rel="prefetch" href="/assets/js/31.34fd8625.js"><link rel="prefetch" href="/assets/js/32.db16b5a4.js"><link rel="prefetch" href="/assets/js/33.5dcf2cd4.js"><link rel="prefetch" href="/assets/js/34.442a8be3.js"><link rel="prefetch" href="/assets/js/35.42205d2e.js"><link rel="prefetch" href="/assets/js/36.4183f0df.js"><link rel="prefetch" href="/assets/js/37.edbadce4.js"><link rel="prefetch" href="/assets/js/38.08f14a56.js"><link rel="prefetch" href="/assets/js/39.831ae06e.js"><link rel="prefetch" href="/assets/js/4.606cd99c.js"><link rel="prefetch" href="/assets/js/40.e6a0cd9e.js"><link rel="prefetch" href="/assets/js/41.59c89272.js"><link rel="prefetch" href="/assets/js/42.b20e4ea2.js"><link rel="prefetch" href="/assets/js/43.d9e31f0d.js"><link rel="prefetch" href="/assets/js/44.c26e40da.js"><link rel="prefetch" href="/assets/js/45.cd6d611a.js"><link rel="prefetch" href="/assets/js/46.0abb047f.js"><link rel="prefetch" href="/assets/js/47.b6b28c06.js"><link rel="prefetch" href="/assets/js/48.4bd49e90.js"><link rel="prefetch" href="/assets/js/49.3820ae7c.js"><link rel="prefetch" href="/assets/js/5.09079429.js"><link rel="prefetch" href="/assets/js/50.e5e8b53c.js"><link rel="prefetch" href="/assets/js/51.6d41569c.js"><link rel="prefetch" href="/assets/js/52.9f684a44.js"><link rel="prefetch" href="/assets/js/54.94191d1f.js"><link rel="prefetch" href="/assets/js/55.8f63ccfb.js"><link rel="prefetch" href="/assets/js/56.7f2ef3fa.js"><link rel="prefetch" href="/assets/js/57.e0e55bd4.js"><link rel="prefetch" href="/assets/js/58.dcbb8281.js"><link rel="prefetch" href="/assets/js/59.02eff4ca.js"><link rel="prefetch" href="/assets/js/6.3c4b6517.js"><link rel="prefetch" href="/assets/js/60.47f5455b.js"><link rel="prefetch" href="/assets/js/61.55dccf8c.js"><link rel="prefetch" href="/assets/js/62.25c52188.js"><link rel="prefetch" href="/assets/js/63.3584d76c.js"><link rel="prefetch" href="/assets/js/64.490d018b.js"><link rel="prefetch" href="/assets/js/65.e5e6c765.js"><link rel="prefetch" href="/assets/js/66.9718a4fe.js"><link rel="prefetch" href="/assets/js/67.29af663e.js"><link rel="prefetch" href="/assets/js/68.51122fa7.js"><link rel="prefetch" href="/assets/js/69.f16d243b.js"><link rel="prefetch" href="/assets/js/7.5dcc397c.js"><link rel="prefetch" href="/assets/js/70.39a7658f.js"><link rel="prefetch" href="/assets/js/71.2eae8541.js"><link rel="prefetch" href="/assets/js/72.f6226007.js"><link rel="prefetch" href="/assets/js/73.4004e54a.js"><link rel="prefetch" href="/assets/js/74.d7b242c4.js"><link rel="prefetch" href="/assets/js/75.fbe74913.js"><link rel="prefetch" href="/assets/js/76.a15f95f0.js"><link rel="prefetch" href="/assets/js/77.29e93c64.js"><link rel="prefetch" href="/assets/js/78.fde575dd.js"><link rel="prefetch" href="/assets/js/79.f083c4ed.js"><link rel="prefetch" href="/assets/js/8.cd10b72e.js"><link rel="prefetch" href="/assets/js/80.a39506a7.js"><link rel="prefetch" href="/assets/js/81.d2e564ac.js"><link rel="prefetch" href="/assets/js/82.2b736524.js"><link rel="prefetch" href="/assets/js/83.bfeab3b8.js"><link rel="prefetch" href="/assets/js/84.a6fdb01c.js"><link rel="prefetch" href="/assets/js/85.f185572b.js"><link rel="prefetch" href="/assets/js/86.f3d4a601.js"><link rel="prefetch" href="/assets/js/87.82cf0bc0.js"><link rel="prefetch" href="/assets/js/88.709f89df.js"><link rel="prefetch" href="/assets/js/89.91994ff2.js"><link rel="prefetch" href="/assets/js/9.9f4472b7.js"><link rel="prefetch" href="/assets/js/90.87f033c7.js"><link rel="prefetch" href="/assets/js/91.6eb63e44.js"><link rel="prefetch" href="/assets/js/92.ac17e9b5.js"><link rel="prefetch" href="/assets/js/93.10b4292f.js"><link rel="prefetch" href="/assets/js/94.12ad7f77.js"><link rel="prefetch" href="/assets/js/95.ce9bd490.js"><link rel="prefetch" href="/assets/js/96.6a11b010.js"><link rel="prefetch" href="/assets/js/97.1ef38c00.js"><link rel="prefetch" href="/assets/js/98.f4912cad.js"><link rel="prefetch" href="/assets/js/99.26ce447a.js">
    <link rel="stylesheet" href="/assets/css/0.styles.471cf497.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">IMBAPUB</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/java/" class="nav-link">
  java
</a></div><div class="nav-item"><a href="/IDE/" class="nav-link">
  IDE
</a></div><div class="nav-item"><a href="/linux/" class="nav-link">
  linux
</a></div><div class="nav-item"><a href="/Python/" class="nav-link">
  Python
</a></div><div class="nav-item"><a href="/Web/" class="nav-link">
  Web
</a></div><div class="nav-item"><a href="/windows/" class="nav-link">
  windows
</a></div><div class="nav-item"><a href="/database/" class="nav-link">
  database
</a></div><div class="nav-item"><a href="/vue/" class="nav-link">
  vue
</a></div><div class="nav-item"><a href="/design/" class="nav-link">
  design
</a></div><div class="nav-item"><a href="/php/" class="nav-link">
  php
</a></div><div class="nav-item"><a href="/safety/" class="nav-link">
  安全
</a></div><div class="nav-item"><a href="/Other/" class="nav-link">
  Other
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/java/" class="nav-link">
  java
</a></div><div class="nav-item"><a href="/IDE/" class="nav-link">
  IDE
</a></div><div class="nav-item"><a href="/linux/" class="nav-link">
  linux
</a></div><div class="nav-item"><a href="/Python/" class="nav-link">
  Python
</a></div><div class="nav-item"><a href="/Web/" class="nav-link">
  Web
</a></div><div class="nav-item"><a href="/windows/" class="nav-link">
  windows
</a></div><div class="nav-item"><a href="/database/" class="nav-link">
  database
</a></div><div class="nav-item"><a href="/vue/" class="nav-link">
  vue
</a></div><div class="nav-item"><a href="/design/" class="nav-link">
  design
</a></div><div class="nav-item"><a href="/php/" class="nav-link">
  php
</a></div><div class="nav-item"><a href="/safety/" class="nav-link">
  安全
</a></div><div class="nav-item"><a href="/Other/" class="nav-link">
  Other
</a></div> <!----></nav>  <!----> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="batch操作"><a href="#batch操作" class="header-anchor">#</a> Batch操作</h1> <ul><li><a href="#flag">flag</a></li> <li><a href="#%E6%89%A7%E8%A1%8Cbash">执行bash</a></li> <li><a href="#%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2">进制转换</a></li> <li><a href="#%E8%8E%B7%E5%8F%96%E7%AE%A1%E7%90%86%E5%91%98%E6%9D%83%E9%99%90">获取管理员权限</a></li> <li><a href="#%E9%9A%90%E8%97%8F%E7%AA%97%E5%8F%A3%E8%BF%90%E8%A1%8C">隐藏窗口运行</a> <ul><li><a href="#bat%E8%84%9A%E6%9C%AC">bat脚本</a></li> <li><a href="#vbs%E8%84%9A%E6%9C%AC">vbs脚本</a></li></ul></li> <li><a href="#%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8">开机启动</a> <ul><li><a href="#%E6%B7%BB%E5%8A%A0%E6%B3%A8%E5%86%8C%E8%A1%A8">添加注册表</a></li> <li><a href="#%E5%90%AF%E5%8A%A8%E7%9B%AE%E5%BD%95">启动目录</a></li></ul></li> <li><a href="#%E6%B3%A8%E5%86%8C%E8%A1%A8">注册表</a> <ul><li><a href="#%E4%BF%AE%E6%94%B9">修改</a></li> <li><a href="#%E7%AA%97%E5%8F%A3%E8%AE%BE%E7%BD%AE">窗口设置</a></li> <li><a href="#%E6%9F%A5%E8%AF%A2">查询</a></li></ul></li> <li><a href="#%E6%B3%A8%E5%86%8C%E6%9C%8D%E5%8A%A1">注册服务</a> <ul><li><a href="#%E5%8A%A0%E5%85%A5%E6%9C%8D%E5%8A%A1">加入服务</a></li> <li><a href="#%E5%88%A0%E9%99%A4%E6%9C%8D%E5%8A%A1">删除服务</a></li></ul></li> <li><a href="#%E7%AC%AC%E4%B8%89%E6%96%B9%E5%B7%A5%E5%85%B7">第三方工具</a></li> <li><a href="#%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6">下载文件</a></li> <li><a href="#%E8%B7%AF%E7%94%B1%E8%B7%9F%E8%B8%AA">路由跟踪</a> <ul><li><a href="#tracert">tracert</a></li></ul></li></ul> <h2 id="flag"><a href="#flag" class="header-anchor">#</a> flag</h2> <ul><li><p><a href="/files/%E6%B7%BB%E5%8A%A0%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F.bat">添加快捷方式</a></p></li> <li><p><a href="/files/%E8%AE%BE%E7%BD%AE%E5%BF%85%E5%BA%94%E5%A3%81%E7%BA%B8.bat">设置必应壁纸</a></p></li> <li><p><a href="/files/%E8%AE%BE%E7%BD%AEgithub%E7%9A%84hosts.bat">设置GitHub的Hosts</a></p></li> <li><p><a href="/files/frpc.bat">frpc.bat</a></p></li></ul> <blockquote><p>会自动检测本地<code>fprc</code>是否为最新版本，如果不是或者没有则下载最新版</p></blockquote> <h2 id="执行powershell"><a href="#执行powershell" class="header-anchor">#</a> 执行PowerShell</h2> <ul><li>为本账户启用策略</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">PowerShell</span> Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser`</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>下载代码并通过<code>Invoke-Expression</code>执行</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">PowerShell</span> Invoke-Expression (New-Object System.Net.WebClient</span><span class="token punctuation">)</span>.DownloadString<span class="token punctuation">(</span><span class="token punctuation">'</span>https://get.scoop.sh<span class="token punctuation">'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>下载文件</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">PowerShell</span> (New-Object System.Net.WebClient</span><span class="token punctuation">)</span>.DownloadFile<span class="token punctuation">(</span><span class="token punctuation">'</span>https://github.com/woytu/woytu.github.io/releases/download/v1.0/7za.exe<span class="token punctuation">'</span>,<span class="token punctuation">'</span>d:\\7za.exe<span class="token punctuation">'</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="进制转换"><a href="#进制转换" class="header-anchor">#</a> 进制转换</h2> <ul><li>十进制转十六进制</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">setlocal</span> enabledelayedexpansion</span>
<span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/p</span> 十进制<span class="token operator">=</span>请输入要转换的十进制数：</span>
<span class="token command"><span class="token keyword">for</span> <span class="token parameter attr-name">/l</span> <span class="token variable">%%a</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token number">1</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token punctuation">(</span>
     <span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> 余<span class="token operator">=</span>十进制<span class="token variable">%%16</span><span class="token punctuation">,</span>十进制<span class="token operator">/=</span><span class="token number">16</span><span class="token punctuation">,</span><span class="token variable">tmp</span><span class="token operator">=</span>余<span class="token operator">+</span><span class="token number">100</span></span>
     <span class="token command"><span class="token keyword">set</span> <span class="token variable">yu</span><span class="token operator">=</span><span class="token variable">!tmp:~1!</span> <span class="token variable">!yu!</span></span>
<span class="token punctuation">)</span>
<span class="token command"><span class="token keyword">set</span> <span class="token variable">yu</span><span class="token operator">=</span><span class="token variable">%yu:00</span><span class="token operator">=</span><span class="token number">0</span><span class="token operator">%</span></span>
<span class="token command"><span class="token keyword">for</span> <span class="token variable">%%a</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span> <span class="token number">6</span> <span class="token number">7</span> <span class="token number">8</span> <span class="token number">9</span> A B C D E F<span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token punctuation">(</span>
     <span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> <span class="token variable">n</span><span class="token operator">+=</span><span class="token number">101</span></span>
     <span class="token command"><span class="token keyword">for</span> <span class="token variable">%%b</span> <span class="token keyword">in</span> <span class="token punctuation">(</span><span class="token variable">!n:~-2!</span><span class="token punctuation">)</span> <span class="token keyword">do</span></span> <span class="token punctuation">(</span>
         <span class="token command"><span class="token keyword">set</span> <span class="token variable">yu</span><span class="token operator">=</span><span class="token operator">!</span>yu: <span class="token variable">%%b</span><span class="token operator">=</span> <span class="token variable">%%a</span><span class="token operator">!</span></span>
     <span class="token punctuation">)</span>
<span class="token punctuation">)</span>
<span class="token command"><span class="token keyword">echo</span> 0x<span class="token variable">%yu:</span> =%</span>
<span class="token command"><span class="token keyword">pause</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><ul><li>十六进制转十进制</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/p</span> 十六进制<span class="token operator">=</span>请输入十六进制数字：</span>
<span class="token command"><span class="token keyword">set</span> <span class="token parameter attr-name">/a</span> 十进制<span class="token operator">=</span>0x<span class="token operator">%</span>十六进制:<span class="token operator">*</span><span class="token variable">x</span><span class="token operator">=</span><span class="token operator">%</span></span>
<span class="token command"><span class="token keyword">echo</span> %十进制%</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h2 id="获取管理员权限"><a href="#获取管理员权限" class="header-anchor">#</a> 获取管理员权限</h2> <ul><li>方式一</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span>
<span class="token command"><span class="token keyword">cacls</span>.exe <span class="token string">&quot;%SystemDrive%\System Volume Information&quot;</span> &gt;nul <span class="token number">2</span>&gt;nul</span>
<span class="token command"><span class="token keyword">if</span> <span class="token keyword">exist</span> <span class="token string">&quot;%temp%\getadmin.vbs&quot;</span></span> <span class="token command"><span class="token keyword">del</span> <span class="token parameter attr-name">/f</span> <span class="token parameter attr-name">/q</span> <span class="token string">&quot;%temp%\getadmin.vbs&quot;</span></span>

<span class="token comment">:: 下面为执行命令</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><ul><li>方式二</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">fltmc</span>&gt;nul||cd<span class="token parameter attr-name">/d</span> <span class="token variable">%~dp0</span> </span><span class="token operator">&amp;</span><span class="token operator">&amp;</span> <span class="token command"><span class="token keyword">mshta</span> vbscript:CreateObject(<span class="token string">&quot;Shell.Application&quot;</span></span><span class="token punctuation">)</span>.ShellExecute<span class="token punctuation">(</span>&quot;%~nx0&quot;,&quot;%1&quot;,&quot;&quot;,&quot;runas&quot;,1<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token command"><span class="token keyword">window</span>.close</span><span class="token punctuation">)</span>

<span class="token comment">:: 下面为执行命令</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>方式三</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span>
<span class="token comment">:: 检查权限</span>
&gt;nul 2&gt;<span class="token operator">&amp;</span><span class="token command"><span class="token keyword">1</span> <span class="token string">&quot;%SYSTEMROOT%\system32\cacls.exe&quot;</span> <span class="token string">&quot;%SYSTEMROOT%\system32\config\system&quot;</span></span>
<span class="token comment">:: 如果没有管理员权限，就请求管理权限</span>
<span class="token command"><span class="token keyword">if</span> '%<span class="token keyword">errorlevel</span>%' <span class="token operator">NEQ</span> '<span class="token number">0</span>'</span> <span class="token punctuation">(</span>
    <span class="token command"><span class="token keyword">goto</span> UACPrompt</span>
<span class="token punctuation">)</span> <span class="token command"><span class="token keyword">else</span></span> <span class="token punctuation">(</span> <span class="token command"><span class="token keyword">goto</span> gotAdmin </span><span class="token punctuation">)</span>

<span class="token label property">:UACPrompt</span>
    <span class="token command"><span class="token keyword">echo</span> Set UAC = CreateObject<span class="token operator">^</span>(<span class="token string">&quot;Shell.Application&quot;</span><span class="token operator">^</span>) &gt; <span class="token string">&quot;%temp%\getadmin.vbs&quot;</span></span>
    <span class="token command"><span class="token keyword">echo</span> UAC.ShellExecute <span class="token string">&quot;%~s0&quot;</span>, <span class="token string">&quot;&quot;</span>, <span class="token string">&quot;&quot;</span>, <span class="token string">&quot;runas&quot;</span>, <span class="token number">1</span> &gt;&gt; <span class="token string">&quot;%temp%\getadmin.vbs&quot;</span></span>
    &quot;%temp%\getadmin.vbs&quot;
    <span class="token command"><span class="token keyword">exit</span> <span class="token parameter attr-name">/B</span></span>

<span class="token label property">:gotAdmin</span>
    <span class="token command"><span class="token keyword">if</span> <span class="token keyword">exist</span> <span class="token string">&quot;%temp%\getadmin.vbs&quot;</span></span> <span class="token punctuation">(</span> <span class="token command"><span class="token keyword">del</span> <span class="token string">&quot;%temp%\getadmin.vbs&quot;</span> </span><span class="token punctuation">)</span>
    <span class="token command"><span class="token keyword">pushd</span> <span class="token string">&quot;%CD%&quot;</span></span>
    <span class="token command"><span class="token keyword">CD</span> <span class="token parameter attr-name">/D</span> <span class="token string">&quot;%~dp0&quot;</span></span>

<span class="token label property">:begin</span>

<span class="token comment">:: 下面为执行命令</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><ul><li>方式四</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code>%1 mshta vbscript:CreateObject<span class="token punctuation">(</span>&quot;Shell.Application&quot;<span class="token punctuation">)</span>.ShellExecute<span class="token punctuation">(</span>&quot;cmd.exe&quot;,&quot;/c %~s0 ::&quot;,&quot;&quot;,&quot;runas&quot;,1<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token command"><span class="token keyword">window</span>.close</span><span class="token punctuation">)</span>
<span class="token command"><span class="token keyword">cd</span> <span class="token parameter attr-name">/d</span> <span class="token string">&quot;%~dp0&quot;</span></span>

<span class="token comment">:: 下面为执行命令</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p><img src="/images/Windows10%E5%90%AF%E7%94%A8%E7%AE%A1%E7%90%86%E5%91%98.png" alt=""></p> <h2 id="隐藏窗口运行"><a href="#隐藏窗口运行" class="header-anchor">#</a> 隐藏窗口运行</h2> <h3 id="bat脚本"><a href="#bat脚本" class="header-anchor">#</a> bat脚本</h3> <blockquote><p>此方式会闪现<code>CMD</code>窗口</p></blockquote> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token operator">@</span><span class="token command"><span class="token keyword">echo</span> off</span>
<span class="token command"><span class="token keyword">if</span> <span class="token string">&quot;%1&quot;</span> == <span class="token string">&quot;h&quot;</span> goto begin</span>
<span class="token command"><span class="token keyword">mshta</span> vbscript:createobject(<span class="token string">&quot;wscript.shell&quot;</span></span><span class="token punctuation">)</span>.run<span class="token punctuation">(</span>&quot;%~0 h&quot;,0<span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token command"><span class="token keyword">window</span>.close</span><span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token operator">&amp;</span><span class="token command"><span class="token keyword">exit</span></span>
<span class="token comment">::mshta &quot;javascript:new ActiveXObject('WScript.Shell').Run('%~0 h',0);window.close()&quot;&amp;&amp;exit</span>
<span class="token label property">:begin</span>

<span class="token comment">:: 下面为执行命令</span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><blockquote><p>如果运行的批处理名为<code>a.bat</code>，在<code>C:\</code>下，那<code>%~0</code>代表<code>C:\a.bat</code>，<code>%~nx0</code>代表<code>a.bat</code>。<code>h</code>极为参数<code>%1</code>，<code>0</code>表示隐藏运行。</p> <p>由于你双击运行，故第一次批处理<code>%1</code>为空，<code>if</code>不成立，转而运行下一句。
然后再次打开自己，并传递参数<code>h</code>，此时<code>if</code>成立，跳转至<code>begin</code>开始运行。</p></blockquote> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token comment">:: 静默运行软件</span>
<span class="token command"><span class="token keyword">Pushd</span> <span class="token variable">%~dp0</span></span>
<span class="token command"><span class="token keyword">start</span> <span class="token parameter attr-name">/wait</span> <span class="token parameter attr-name">/B</span> <span class="token string">&quot;&quot;</span> <span class="token string">&quot;%~dp0软件名称&quot;</span> <span class="token parameter attr-name">/S</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token comment">:: 添加开机静默启动</span>
<span class="token command"><span class="token keyword">Pushd</span> <span class="token variable">%~dp0</span></span>
<span class="token command"><span class="token keyword">start</span> <span class="token parameter attr-name">/wait</span> <span class="token parameter attr-name">/B</span> <span class="token string">&quot;&quot;</span> <span class="token string">&quot;%~dp0软件名称&quot;</span> <span class="token parameter attr-name">/ADD</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token comment">:: 删除开机静默启动</span>
<span class="token command"><span class="token keyword">Pushd</span> <span class="token variable">%~dp0</span></span>
<span class="token command"><span class="token keyword">start</span> <span class="token parameter attr-name">/wait</span> <span class="token parameter attr-name">/B</span> <span class="token string">&quot;&quot;</span> <span class="token string">&quot;%~dp0软件名称&quot;</span> <span class="token parameter attr-name">/DEL</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="vbs脚本"><a href="#vbs脚本" class="header-anchor">#</a> vbs脚本</h3> <blockquote><p>此方式完全不会显示<code>CMD</code>窗口（包括闪现）</p></blockquote> <div class="language-visual-basic line-numbers-mode"><pre class="language-visual-basic"><code><span class="token comment">' 创建运行命令数组</span>
commands <span class="token operator">=</span> Array<span class="token punctuation">(</span><span class="token string">&quot;D:\frp内网穿透工具\frpc.exe -c D:\frp内网穿透工具\frpc.ini&quot;</span><span class="token punctuation">)</span>

<span class="token comment">' 创建运行命令动态数组</span>
<span class="token comment">'Set commands = CreateObject(&quot;System.Collections.ArrayList&quot;)</span>
<span class="token comment">'commands.Add &quot;D:\frp内网穿透工具\frpc.exe -c D:\frp内网穿透工具\frpc.ini&quot;</span>

<span class="token comment">' 启动项键名称</span>
keyName <span class="token operator">=</span> <span class="token string">&quot;frp&quot;</span>

<span class="token keyword">Set</span> shell <span class="token operator">=</span> WScript<span class="token punctuation">.</span>CreateObject<span class="token punctuation">(</span><span class="token string">&quot;WScript.Shell&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">For</span> <span class="token keyword">Each</span> command <span class="token keyword">In</span> commands
    <span class="token comment">' cmd /c运行之后关闭窗口，0隐藏运行，false不同步运行</span>
    shell<span class="token punctuation">.</span>Run <span class="token string">&quot;cmd /c &quot;</span> <span class="token operator">&amp;</span> command<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">false</span>
<span class="token keyword">Next</span>

<span class="token comment">' 注册表项</span>
item <span class="token operator">=</span> <span class="token string">&quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Run\&quot;</span>

<span class="token comment">' 设置开机启动</span>
shell<span class="token punctuation">.</span>RegWrite item <span class="token operator">&amp;</span> keyName<span class="token punctuation">,</span> WScript<span class="token punctuation">.</span>ScriptFullName
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><div class="language-visual-basic line-numbers-mode"><pre class="language-visual-basic"><code>ProcesseName<span class="token operator">=</span><span class="token string">&quot;rclone.exe&quot;</span>

<span class="token comment">' 查找进程</span>
<span class="token keyword">Set</span> WMIService <span class="token operator">=</span> GetObject<span class="token punctuation">(</span><span class="token string">&quot;winmgmts:{impersonationlevel=impersonate}!\\.\root\cimv2&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">Set</span> Processes <span class="token operator">=</span> WMIService<span class="token punctuation">.</span>ExecQuery<span class="token punctuation">(</span><span class="token string">&quot;select * from win32_process where name='&quot;</span> <span class="token operator">&amp;</span> ProcesseName <span class="token operator">&amp;</span> <span class="token string">&quot;'&quot;</span><span class="token punctuation">)</span>

<span class="token keyword">For</span> <span class="token keyword">Each</span> Process <span class="token keyword">In</span> Processes
    <span class="token comment">' 比较两个字符串</span>
    <span class="token keyword">If</span> InStr<span class="token punctuation">(</span>UCase<span class="token punctuation">(</span>Process<span class="token punctuation">.</span>name<span class="token punctuation">)</span><span class="token punctuation">,</span> UCase<span class="token punctuation">(</span>ProcesseName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token number">0</span> <span class="token keyword">Then</span>
        <span class="token keyword">Exit</span> <span class="token keyword">for</span>
    <span class="token keyword">End</span> <span class="token keyword">If</span>
    <span class="token comment">' 运行程序</span>
    <span class="token keyword">Set</span> WS <span class="token operator">=</span> Wscript<span class="token punctuation">.</span>CreateObject<span class="token punctuation">(</span><span class="token string">&quot;Wscript.Shell&quot;</span><span class="token punctuation">)</span>
    WS<span class="token punctuation">.</span>Run <span class="token string">&quot;rclone mount GDrive:/ x: --cache-dir F:\Temp --vfs-cache-mode writes&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span>
<span class="token keyword">Next</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="开机启动"><a href="#开机启动" class="header-anchor">#</a> 开机启动</h2> <h3 id="添加注册表"><a href="#添加注册表" class="header-anchor">#</a> 添加注册表</h3> <blockquote><p><code>Run</code>键值代表着开机启动项，也就是说在这个项下的键值会随着开机启动
（这里的开机是指用户登录，也就是说只要有登录操作就会执行，注销然后登录，也会执行这个键值）。</p></blockquote> <blockquote><p><code>RunOnce</code>键值类似于<code>Run</code>键值，唯一的区别在于，<code>RunOnce</code>键值只执行一次，操作执行后会被自动删除。</p></blockquote> <ul><li>用户启动项</li></ul> <ol><li><code>HKCU\Software\Microsoft\Windows\CurrentVersion\Run</code></li> <li><code>HKCU\Software\Microsoft\Windows\CurrentVersion\RunOnce</code></li></ol> <ul><li>本机启动项</li></ul> <ol><li><code>HKLM\SYSTEM\CurrentControlSet\Control\Session Manager</code></li> <li><code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run</code></li> <li><code>HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce</code></li> <li><code>HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Run</code></li> <li><code>HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\RunOnce</code></li></ol> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&quot;</span> <span class="token parameter attr-name">/v</span> 软件名 <span class="token parameter attr-name">/d</span> 软件路径 <span class="token parameter attr-name">/f</span></span>
<span class="token comment">:: 或者，%号和&quot;号不能使用转移字符^转义，%号转义%%，&quot;号转义&quot;&quot;&quot;</span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&quot;</span> <span class="token parameter attr-name">/v</span> 软件名 <span class="token parameter attr-name">/d</span> <span class="token string">&quot;&quot;</span><span class="token string">&quot;&quot;</span>软件路径<span class="token string">&quot;&quot;</span><span class="token string">&quot; /background&quot;</span> <span class="token parameter attr-name">/f</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="启动目录"><a href="#启动目录" class="header-anchor">#</a> 启动目录</h3> <blockquote><p>把软件的快捷方式或者软件直接放在以下目录中就会开机自动运行</p></blockquote> <blockquote><p>可利用<a href="/VPS/BAT脚本.html#添加快捷方式">脚本添加快捷方式</a>直接在启动文件夹中生成快捷方式</p></blockquote> <blockquote><p>按<code>win+r</code>打开运行窗口，输入<code>shell:startup</code>打开启动文件夹，把快捷方式或者软件放入</p></blockquote> <ul><li><p>Win7及以上（当前用户）: <code>%AppData%\Microsoft\Windows\Start Menu\Programs\Startup</code></p></li> <li><p>启动目录（所有用户）: <code>%ProgramData%\Microsoft\Windows\Start Menu\Programs\StartUp</code></p></li></ul> <h2 id="注册表"><a href="#注册表" class="header-anchor">#</a> 注册表</h2> <blockquote><p>注册表被称为Windows操作系统的核心，它的工作原理实质是一个庞大的数据库，存放了关于计算机硬件的配置信息、
系统和应用软件的初始化信息、应用软件和文档文件的关联关系、硬件设备的说明以及各种状态信息和数据，
包括Windows操作时不断引用的信息。</p></blockquote> <blockquote><p>例如：系统中的硬件资源、硬件信息、分配正在使用的端口、
每个用户的配置文件、计算机上安装的应用程序以及每个应用程序可以创建的文件类型等。</p></blockquote> <blockquote><p>组策略设置的实质是修改注册表中的配置</p></blockquote> <ul><li>主要作用</li></ul> <ol><li>记录安装信息</li> <li>设置硬件</li> <li>设置软件</li> <li>定制Windows</li> <li>系统安全管理</li> <li>自动运行程序</li> <li>网络设置</li></ol> <ul><li><p><a href="https://zhuanlan.zhihu.com/p/72194354" target="_blank" rel="noopener noreferrer">Windows注册表内容详解<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://segmentfault.com/a/1190000016854021" target="_blank" rel="noopener noreferrer">简析Windows注册表<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://www.cnblogs.com/weiyinfu/p/10961872.html" target="_blank" rel="noopener noreferrer">windows注册表<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <ul><li>注册表的分支结构</li></ul> <table><thead><tr><th>注册表短根键名</th> <th>注册表长根键名</th> <th>作用</th></tr></thead> <tbody><tr><td>HKCU</td> <td>HKEY_CURRENT_USER</td> <td>存储当前用户设置的信息。当前用户登录后才执行的操作</td></tr> <tr><td>HKLM</td> <td>HKEY_LOCAL_MACHINE</td> <td>包括安装在计算机上的硬件和软件的信息。所有操作在用户登录前就执行了</td></tr> <tr><td>HKCR</td> <td>HKEY_CLASSES_ROOT</td> <td>存储Windows可识别的文件类型的详细列表，以及相关联的程序。</td></tr> <tr><td>HKEY_USERS</td> <td>HKEY_USERS</td> <td>包含使用计算机的用户的信息。</td></tr> <tr><td>HKEY_CURRENT_CONFIG</td> <td>HKEY_CURRENT_CONFIG</td> <td>这个分支包含计算机当前的硬件配置信息。</td></tr></tbody></table> <h3 id="regini"><a href="#regini" class="header-anchor">#</a> regini</h3> <ul><li><a href="https://docs.microsoft.com/zh-cn/windows-server/administration/windows-commands/regini" target="_blank" rel="noopener noreferrer">regini和其他所有命令官方文档<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <table><thead><tr><th>权限</th> <th>说明</th></tr></thead> <tbody><tr><td>1</td> <td>Administrators 完全访问</td></tr> <tr><td>2</td> <td>Administrators 只读访问</td></tr> <tr><td>3</td> <td>Administrators 读和写入访问</td></tr> <tr><td>4</td> <td>Administrators 读、写入、删除访问</td></tr> <tr><td>5</td> <td>Creator 完全访问</td></tr> <tr><td>6</td> <td>Creator 读和写入访问</td></tr> <tr><td>7</td> <td>everyone 完全访问</td></tr> <tr><td>8</td> <td>everyone 只读访问</td></tr> <tr><td>9</td> <td>everyone 读和写入访问</td></tr> <tr><td>10</td> <td>everyone 读、写入、删除访问</td></tr> <tr><td>11</td> <td>Power Users 完全访问</td></tr> <tr><td>12</td> <td>Power Users 读和写入访问</td></tr> <tr><td>13</td> <td>Power Users 读、写入、删除访问</td></tr> <tr><td>14</td> <td>System Operators 完全访问</td></tr> <tr><td>15</td> <td>System Operators 读和写入访问</td></tr> <tr><td>16</td> <td>System Operators 读、写入、删除访问</td></tr> <tr><td>17</td> <td>System 完全访问</td></tr> <tr><td>18</td> <td>System 读和写入访问</td></tr> <tr><td>19</td> <td>System 只读访问</td></tr> <tr><td>20</td> <td>Administrators 读、写、执行访问</td></tr> <tr><td>21</td> <td>Interactive User 完全访问</td></tr> <tr><td>22</td> <td>Interactive User 读和写入访问</td></tr> <tr><td>23</td> <td>Interactive User 读、写入、删除访问</td></tr></tbody></table> <h3 id="修改"><a href="#修改" class="header-anchor">#</a> 修改</h3> <blockquote><p><code>/v</code> 设置键名(value)</p></blockquote> <blockquote><p><code>/t</code> 设置数据类型(type)</p></blockquote> <blockquote><p><code>/d</code> 设置添加的值(data)</p></blockquote> <blockquote><p><code>/f</code> 表示强制(forbidden)</p></blockquote> <ul><li>删除桌面IE图标</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> DELETE <span class="token string">&quot;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Desktop\NameSpace\{B416D21B-3B22-B6D4-BBD3-BBD452DB3D5B}&quot;</span> <span class="token parameter attr-name">/f</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>修改开机时小数字键盘不开启的问题</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKU\.DEFAULT\Control Panel\Keyboard&quot;</span> <span class="token parameter attr-name">/v</span> InitialKeyboardIndicators <span class="token parameter attr-name">/t</span> REG_SZ <span class="token parameter attr-name">/d</span> <span class="token number">2</span> <span class="token parameter attr-name">/f</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>把图片设置为壁纸</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKCU\Control Panel\Desktop&quot;</span> <span class="token parameter attr-name">/v</span> TileWallpaper <span class="token parameter attr-name">/d</span> <span class="token string">&quot;0&quot;</span> <span class="token parameter attr-name">/f</span> </span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKCU\Control Panel\Desktop&quot;</span> <span class="token parameter attr-name">/v</span> Wallpaper <span class="token parameter attr-name">/d</span> <span class="token string">&quot;图片绝对路径&quot;</span> <span class="token parameter attr-name">/f</span></span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKCU\Control Panel\Desktop&quot;</span> <span class="token parameter attr-name">/v</span> WallpaperStyle <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/d</span> <span class="token number">2</span> <span class="token parameter attr-name">/f</span></span>
<span class="token command"><span class="token keyword">RunDll32</span>.exe USER32.DLL,UpdatePerUserSystemParameters</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><ul><li>开机自动运行</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKCU\Software\Microsoft\Windows\CurrentVersion\Run&quot;</span> <span class="token parameter attr-name">/v</span> 自定义命名 <span class="token parameter attr-name">/d</span> <span class="token variable">%0</span> <span class="token parameter attr-name">/f</span></span>

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>替换默认记事本</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe&quot;</span> <span class="token parameter attr-name">/v</span> <span class="token string">&quot;Debugger&quot;</span> <span class="token parameter attr-name">/t</span> REG_SZ <span class="token parameter attr-name">/d</span> <span class="token string">&quot;\&quot;</span><span class="token variable">%ProgramFiles</span>(x86</span><span class="token punctuation">)</span>%\Notepad3\notepad3.exe\&quot; -notepadStyleCmdline -z&quot; /f
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li>恢复系统默认记事本</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">REG</span> DELETE <span class="token string">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe&quot;</span> <span class="token parameter attr-name">/f</span></span>
<span class="token command"><span class="token keyword">REG</span> DELETE <span class="token string">&quot;HKLM\Software\Wow6432Node\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe&quot;</span> <span class="token parameter attr-name">/f</span></span>
<span class="token command"><span class="token keyword">REG</span> DELETE <span class="token string">&quot;HKLM\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\notepad.exe&quot;</span> <span class="token parameter attr-name">/v</span> <span class="token string">&quot;Debugger&quot;</span> <span class="token parameter attr-name">/f</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><ul><li>Windows Defender</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token comment">:: 关闭“启用Windows安全中心服务”的通知</span>
<span class="token command"><span class="token keyword">REG</span> DELETE <span class="token string">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellServiceObjects\{F56F6FDD-AA9D-4618-A949-C1B91AF43B1A}&quot;</span> <span class="token parameter attr-name">/f</span></span>

<span class="token comment">:: 关闭Windows Defender</span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender&quot;</span> <span class="token parameter attr-name">/v</span> <span class="token string">&quot;DisableAntiSpyware&quot;</span> <span class="token parameter attr-name">/d</span> <span class="token number">1</span> <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/f</span></span>

<span class="token comment">:: 启用Windows Defender</span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKEY_LOCAL_MACHINE\SOFTWARE\Policies\Microsoft\Windows Defender&quot;</span> <span class="token parameter attr-name">/v</span> <span class="token string">&quot;DisableAntiSpyware&quot;</span> <span class="token parameter attr-name">/d</span> <span class="token number">0</span> <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/f</span>   </span>
   
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h3 id="窗口设置"><a href="#窗口设置" class="header-anchor">#</a> 窗口设置</h3> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">Mode</span> con cols=宽分辨率 lines=高分辨率</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><blockquote><p>窗口大小是被改成了你想要的, 可是屏幕缓冲区的大小也变成了一样，这让你无法追溯屏幕打印的历史，
也就是说<code>mode</code>对于窗口大小和屏幕缓冲区大小不能单独设置。</p></blockquote> <blockquote><p>解决办法就是修改注册表，先要知道保存系统默认的<code>cmd</code>命令窗口的屏幕缓冲区大小的两个键值</p></blockquote> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token comment">:: 窗口大小</span>
<span class="token command"><span class="token keyword">HKEY_CURRENT_USER</span>\Console\ScreenBufferSize</span>

<span class="token comment">:: 屏幕缓冲区大小</span>
<span class="token command"><span class="token keyword">HKEY_CURRENT_USER</span>\Console\WindowSize</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><blockquote><p>值是用的十六进制值来表示的，十六进制可以前加零来补齐为8位来理解</p> <p>十六进制的前四位是高，后四位是宽</p></blockquote> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token comment">:: 窗口高宽40*120</span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKEY_CURRENT_USER\Console&quot;</span> <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/v</span> WindowSize <span class="token parameter attr-name">/d</span> 0x00280078 <span class="token parameter attr-name">/f</span></span>
<span class="token comment">:: 屏幕缓冲区高宽1000*120</span>
<span class="token command"><span class="token keyword">REG</span> ADD <span class="token string">&quot;HKEY_CURRENT_USER\Console&quot;</span> <span class="token parameter attr-name">/t</span> REG_DWORD <span class="token parameter attr-name">/v</span> ScreenBufferSize <span class="token parameter attr-name">/d</span> 0x03e80078 <span class="token parameter attr-name">/f</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h3 id="查询"><a href="#查询" class="header-anchor">#</a> 查询</h3> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>FOR /F <span class="token string">&quot;usebackq delims==&quot;</span> %i IN <span class="token punctuation">(</span><span class="token variable"><span class="token variable">`</span>REG QUERY HKCU /v onedrive /s<span class="token variable">`</span></span><span class="token punctuation">)</span> DO @echo %i
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="注册服务"><a href="#注册服务" class="header-anchor">#</a> 注册服务</h2> <ul><li><a href="https://www.cnblogs.com/pingming/p/5108947.html" target="_blank" rel="noopener noreferrer">https://www.cnblogs.com/pingming/p/5108947.html<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h3 id="加入服务"><a href="#加入服务" class="header-anchor">#</a> 加入服务</h3> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token comment">:: 等号后面的空格必须</span>
<span class="token command"><span class="token keyword">sc</span> create 服务名称 binPath= 执行程序路径或者命令 start= auto displayname= <span class="token string">&quot;描述&quot;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><ul><li>示例</li></ul> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">sc</span> create frp内网穿透 binPath= D:\frp\frps.bat start= auto displayname= <span class="token string">&quot;frp内网穿透&quot;</span></span>

<span class="token command"><span class="token keyword">sc</span> create frp内网穿透 binPath= <span class="token string">&quot;cmd.exe /c D:\frp内网穿透工具\frpc.exe -c D:\frp内网穿透工具\frpc.ini&quot;</span> start= auto displayname= <span class="token string">&quot;frp内网穿透&quot;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="删除服务"><a href="#删除服务" class="header-anchor">#</a> 删除服务</h3> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">sc</span> delete 服务名称</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="第三方工具"><a href="#第三方工具" class="header-anchor">#</a> 第三方工具</h2> <ul><li><p><a href="https://eternallybored.org/misc/wget/" target="_blank" rel="noopener noreferrer">wget-网络请求工具<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://curl.haxx.se/dlwiz/?type=bin" target="_blank" rel="noopener noreferrer">curl-网络请求工具<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="https://github.com/curl/curl" target="_blank" rel="noopener noreferrer">curl-GitHub<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://github.com/stedolan/jq" target="_blank" rel="noopener noreferrer">jq-解析json工具<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="http://www.bathome.net/thread-32322-1-1.html" target="_blank" rel="noopener noreferrer">Batch-CN-在线第三方管理<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <a href="http://bcn.bathome.net/s/tool/index.html" target="_blank" rel="noopener noreferrer">bcn<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li> <li><p><a href="https://imagemagick.org/index.php" target="_blank" rel="noopener noreferrer">转换位图图像<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></li></ul> <h2 id="下载文件"><a href="#下载文件" class="header-anchor">#</a> 下载文件</h2> <ul><li>推荐使用<code>bat</code>脚本执行<code>JavaScript</code>脚本下载文件</li></ul> <ul><li><a href="https://3gstudent.github.io/3gstudent.github.io/%E6%B8%97%E9%80%8F%E6%8A%80%E5%B7%A7-%E4%BB%8Egithub%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%9A%E7%A7%8D%E6%96%B9%E6%B3%95/" target="_blank" rel="noopener noreferrer">从github下载文件的多种方法<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <ul><li><code>certutil</code></li></ul> <blockquote><p>用户备份证书服务管理，每次下载都会有缓存</p> <p>缓存目录：<code>%USERPROFILE%\AppData\LocalLow\Microsoft\CryptnetUrlCache\Content</code></p></blockquote> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token command"><span class="token keyword">certutil</span> -urlcache -split <span class="token parameter attr-name">-f</span> https://blog-static.cnblogs.com/files/gayhub/bcn.js C:\Windows\bcn.bat</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><code>bitsadmin</code></li></ul> <blockquote><p><code>bitsadmin.exe</code> <code>bitsadmin</code>是<code>windows</code>后台智能传输服务的一个工具，<code>windows</code>的自动更新，补丁之类的下载就是用这个工具来实现的。</p></blockquote> <div class="language-batch line-numbers-mode"><pre class="language-batch"><code><span class="token comment">:: 无进度条等信息</span>
<span class="token command"><span class="token keyword">bitsadmin</span> <span class="token parameter attr-name">/rawreturn</span> <span class="token parameter attr-name">/transfer</span> 任务名 https://blog-static.cnblogs.com/files/gayhub/bcn.js C:\Windows\bcn.bat</span>
<span class="token comment">:: 有进度条等信息</span>
<span class="token command"><span class="token keyword">bitsadmin</span> <span class="token parameter attr-name">/transfer</span> 任务名 <span class="token parameter attr-name">/download</span> <span class="token parameter attr-name">/priority</span> normal https://blog-static.cnblogs.com/files/gayhub/bcn.js C:\Windows\bcn.bat</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="路由跟踪"><a href="#路由跟踪" class="header-anchor">#</a> 路由跟踪</h2> <h3 id="tracert"><a href="#tracert" class="header-anchor">#</a> tracert</h3> <blockquote><p>Tracert（跟踪路由）是一个简单的网络诊断工具，可以列出分组经过的路由节点，以及它在IP 网络中每一跳的延迟。（这里的延迟是指：分组从信息源发送到目的地所需的时间，延迟也分为许多的种类——传播延迟、传输延迟、处理延迟、排队延迟等，是大多数网站性能的瓶颈之一）.</p></blockquote> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>tracert <span class="token punctuation">[</span>-d<span class="token punctuation">]</span> <span class="token punctuation">[</span>-h maximum_hops<span class="token punctuation">]</span> <span class="token punctuation">[</span>-j host-list<span class="token punctuation">]</span> <span class="token punctuation">[</span>-w timeout<span class="token punctuation">]</span> <span class="token punctuation">[</span>-R<span class="token punctuation">]</span> <span class="token punctuation">[</span>-S srcaddr<span class="token punctuation">]</span> <span class="token punctuation">[</span>-4<span class="token punctuation">]</span> <span class="token punctuation">[</span>-6<span class="token punctuation">]</span> target_name
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><ul><li><p><strong>选项</strong></p></li> <li><p><code>-d</code> 指定不将 IP 地址解析到主机名称。</p></li> <li><p><code>-h maximum_hops</code> 指定跃点数以跟踪到称为 target_name 的主机的路由。</p></li> <li><p><code>-j host-list</code> 指定 Tracert 实用程序数据包所采用路径中的路由器接口列表。</p></li> <li><p><code>-w timeout</code> 等待 timeout 为每次回复所指定的毫秒数。</p></li> <li><p><code>target_name</code> 目标主机的名称或 IP 地址。</p></li> <li><p><strong>示例</strong></p></li></ul> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>tracert www.woytu.com
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">6/6/2020, 7:21:36 AM</span></div></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.c2625d5e.js" defer></script><script src="/assets/js/2.3a46498f.js" defer></script><script src="/assets/js/53.1fb124a5.js" defer></script>
  </body>
</html>
